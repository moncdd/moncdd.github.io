<!doctype html>
<html lang="es">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>5.9. Ficheros | Unidad 05 </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.8 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site" id="exe-node-62"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<header id="header" ><div id="headerContent">Unidad 05</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Unidad 5. Utilización de técnicas de acceso a datos</a></li>
   <li><a href="51_acceso_a_bases_de_datos_desde_php.html" class="no-ch">5.1. Acceso a bases de datos desde PHP</a></li>
   <li><a href="52_utilizacin_de_bases_de_datos_mysql_en_php.html" class="no-ch">5.2. Utilización de bases de datos MySQL en PHP</a></li>
   <li><a href="53_extensin_mysqli.html" class="no-ch">5.3. Extensión MySQLi</a></li>
   <li><a href="54_php_data_objects_pdo.html" class="no-ch">5.4. PHP Data Objects (PDO)</a></li>
   <li><a href="55_errores_y_manejo_de_excepciones.html" class="no-ch">5.5. Errores y manejo de excepciones</a></li>
   <li><a href="56_expresiones_regulares.html" class="no-ch">5.6. Expresiones regulares</a></li>
   <li><a href="57_filtrado_de_datos.html" class="no-ch">5.7. Filtrado de datos</a></li>
   <li><a href="58_xml.html" class="no-ch">5.8. XML</a></li>
   <li id="active"><a href="59_ficheros.html" class="active no-ch">5.9. Ficheros</a></li>
   <li><a href="510_encriptacin_y_contraseas.html" class="no-ch">5.10. Encriptación y contraseñas</a></li>
   <li><a href="511_subida_y_bajada_de_archivos.html" class="no-ch">5.11. Subida y bajada de archivos</a></li>
   <li><a href="512_paginacin.html" class="no-ch">5.12. Paginación</a></li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="58_xml.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="510_encriptacin_y_contraseas.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">5.9. Ficheros</h1></header>
<article class="iDevice_wrapper textIdevice" id="id160">
<div class="iDevice emphasis0" >
<div id="ta160_160_2" class="block iDevice_content">
<div class="exe-text"><p>Los <strong>archivos en PHP</strong> se abren con la función <em><strong>fopen()</strong></em>, que requiere dos parámetros: el <strong>archivo que se quiere abrir</strong> y el <strong>modo en el que abrir el archivo</strong>. La función devuelve un <strong>puntero</strong> en el archivo si es satisfactoria o <strong>cero</strong> si no lo es. Los archivos se abren para realizar operaciones de lectura o escritura.</p>
<blockquote>
<p>$fp = fopen("miarchivo.txt", "r");</p>
</blockquote>
<p>Si no es posible abrir el archivo, devuelve cero, por eso es frecuente utilizar esta función en una condición:</p>
<blockquote>
<p>if (!$fp = fopen("miarchivo.txt", "r")){<br />   echo "No se ha podido abrir el archivo";<br />}</p>
</blockquote>
<p>Se puede abrir un archivo pero también una <strong>URL externa</strong>, ya que <em>fopen()</em> realmente lo que hace es crear una conexión, por eso hay que cerrarla posteriormente.</p>
<blockquote>
<p>$fp = fopen("http://localhost:8000", "r");</p>
</blockquote>
<p>Los <strong>modos de acceso existentes para fopen</strong> son:</p>
<pre><code class="hljs php"></code></pre>
<pre><code class="hljs php"><span class="hljs-variable"></span></code></pre>
<table border="1" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th>Modo</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><strong>r</strong></td>
<td>Apertura para lectura. Puntero al principio del archivo</td>
</tr>
<tr>
<td style="text-align: center;"><strong>r+</strong></td>
<td>Apertura para lectura y escritura. Puntero al principio del archivo</td>
</tr>
<tr>
<td style="text-align: center;"><strong>w</strong></td>
<td>Apertura para escritura. Puntero al principio del archivo y lo sobreescribe. Si no existe se intenta crear.</td>
</tr>
<tr>
<td style="text-align: center;"><strong>w+</strong></td>
<td>Apertura para lectura y escritura. Puntero al principio del archivo y lo sobreescribe. Si no existe se intenta crear.</td>
</tr>
<tr>
<td style="text-align: center;"><strong>a</strong></td>
<td>Apertura para escritura. Puntero al final del archivo. Si no existe se intenta crear.</td>
</tr>
<tr>
<td style="text-align: center;"><strong>a+</strong></td>
<td>Apertura para lectura y escritura. Puntero al final del archivo. Si no existe se intenta crear.</td>
</tr>
<tr>
<td style="text-align: center;"><strong>x</strong></td>
<td>Creación y apertura para sólo escritura. Puntero al principio del archivo. Si el archivo ya existe dará error E_WARNING. Si no existe se intenta crear.</td>
</tr>
<tr>
<td style="text-align: center;"><strong>x+</strong></td>
<td>Creación y apertura para lectura y escritura. Mismo comportamiento que x.</td>
</tr>
<tr>
<td style="text-align: center;"><strong>c</strong></td>
<td>Apertura para escritura. Si no existe se crea. Si existe no se sobreescribe ni da ningún error. Puntero al principio del archivo.</td>
</tr>
<tr>
<td style="text-align: center;"><strong>c+</strong></td>
<td>Apertura para lectura y escritura. Mismo comportamiento que C.</td>
</tr>
</tbody>
</table>
<p>Algunas <strong>consideraciones</strong> de la tabla:</p>
<ul>
<li>Si el archivo no es escribible, abrirlo con <em>r+</em> fallará, incluso cuando sólo se intenta leer.</li>
<li><em>w</em> y <em>w+</em> eliminarán el contenido de cualquier archivo. Para sólo añadir y no borrar, se usa a y <em>a+</em>.</li>
<li>Si quieres crear nuevos archivos y evitar sobreescribir sin querer un archivo existente, utiliza <em>x</em> o <em>x+</em>.</li>
<li>Cuando se trabaja con <strong>archivos binarios</strong>, como imágenes, hay que añadir 'b' después del modo. Como <em>rb</em> o <em>r+b</em></li>
</ul>
<p>Una vez abierto el archivo, vamos a leerlo y guardar sus contenidos en una variable con <em>fread()</em>:</p>
<blockquote>
<p>$file = "miarchivo.txt";<br />$fp = fopen($file, "r");<br />$contents = fread($fp, filesize($file));</p>
</blockquote>
<p>La variable <em>$contents</em> guardará el contenido que obtengamos con la función <em>fread()</em>. Esta función requiere dos parámetros, el archivo abierto y la longitud que queremos leer de dicho archivo (en bytes). En este caso hemos empleado la función <em>filesize()</em> para obtener el tamaño del archivo y así devolver todo su contenido.</p>
<pre><code class="hljs php"><span class="hljs-variable"></span></code></pre>
<p>Finalmente, vamos a cerrar el archivo (no es obligatorio pero se recomienda):</p>
<blockquote>
<p>fclose($fp);</p>
</blockquote>
<p>Al igual que para <strong>leer un archivo</strong>, hay más de una forma de <strong>escribir</strong> en uno. La forma más básica es utilizar la función <em>fwrite()</em> (o <em>fputs()</em>, que es su alias):</p>
<blockquote>
<p>$file = "miarchivo.txt";<br />$texto = "Hola que tal";<br />$fp = fopen($file, "w");<br />fwrite($fp, $texto);<br />fclose($fp);</p>
</blockquote>
<p>Esta vez hemos empleado el <strong>modo w</strong>, que permite escribir sobreescribiendo el archivo.</p>
<pre><code class="hljs php"><span class="hljs-variable"></span></code></pre>
<p>Podemos <strong>limitar la longitud de datos que queremos escribir</strong> (todos los datos que había en el archivo se borrarán por completo igualmente):</p>
<blockquote>
<p>$file = "miarchivo.txt";<br />$texto = "Hola que tal";<br />$fp = fopen($file, "w");<br />fwrite($fp, $texto, 4); // Escribirá sólo: Hola</p>
</blockquote>
<p>Si el archivo <em>miarchivo.txt</em> no existe, se creará automáticamente con el <strong>modo w de la función fopen</strong>.</p>
<pre><code class="hljs php"><span class="hljs-variable"></span></code></pre></div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice" id="id164">
<div class="iDevice emphasis1" >
<header class="iDevice_header iDevice_header_noIcon"><h1 class="iDeviceTitle">5.9.1. Lectura de ficheros</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta164_164_2" class="block iDevice_content">
<div class="exe-text"><ul>
<li>fgets: Obtiene una línea desde el <strong>puntero de un archivo</strong>. La <strong>lectura</strong> termina cuando se llegue a <em>$length</em>, se llegue a una nueva línea o se alcance el final del archivo.</li>
</ul>
<blockquote>
<p>$fp = fopen("miarchivo.txt", "r");<br />while (!feof($fp)){<br />   $linea = fgets($fp);<br />   echo $linea;<br />}<br />fclose($fp);</p>
</blockquote>
<ul>
<li>fread: Lectura de un fichero en <strong>modo binario</strong>. Se puede incluir un parámetro opcional <em>$length</em> para limitar lo que devuelva. Esta función tiene una función diferente a <em>fgets()</em>, ya que lee <strong>archivos binarios</strong> (archivos que no están creados para ser legibles por humanos). Ya que las líneas no son algo muy común en este tipo de archivos, se suele especificar el tamaño <em>$length</em> en bytes a devolver:</li>
</ul>
<blockquote>
<p>$fp = fopen ("miarchivo.txt", "rb");<br />$datos = fread($fp, 4096);</p>
<p>Es frecuente emplear la función <em>filesize()</em> en lugar de un número concreto para especificar que se quiere devolver el archivo entero:</p>
<p>$fp = fopen("miarchivo.txt", "rb");<br />$datos = fread($fp, filesize("miarchivo.txt"));<br />fclose($fp);</p>
</blockquote>
<ul>
<li>fscanf: Interpreta la entrada de un archivo <em>$handle</em> en función de un formato <em>$format</em>. El formato es el mismo que se emplea en la función <em>sprintf()</em>. Cada llamada a <em>fscanf()</em> lee una línea del archivo.</li>
</ul>
<blockquote>
<p>$fp = fopen("miarchivo.txt", "r");<br />while ($animalinfo = fscanf($fp, "%s\t%s")){<br />   list($animal, $nombre) = $animalinfo;<br />   echo "El " . $animalinfo[0] . " se llama {$animalinfo[1]} &lt;br&gt;";<br />}<br />fclose($fp);</p>
</blockquote>
<ul>
<li>fgetss: Es igual que <em>fgets()</em> pero elimina cualquier <strong>null</strong>, <strong>etiquetas HTML y PHP</strong> del texto. Se puede especificar un parámetro opcional _$allowable<em>tags</em> para especificar etiquetas que se permiten.</li>
</ul>
<blockquote>
<p>$cadena = &lt;&lt;&lt;HEY<br />   &lt;html&gt;<br />      &lt;h1&gt;Perfil de &lt;?php echo "Nombre de usuario";?&gt;&lt;/h1&gt;<br />   &lt;/html&gt;<br />HEY;</p>
<p>$file = "miarchivo.txt";<br />file_put_contents($file, $cadena);</p>
<p>$gestor = fopen($file, "r");</p>
<p>while (!feof($gestor)){<br />   $buffer = fgetss($gestor, 4096);<br />   echo $buffer;<br />}<br />fclose($gestor);<br />// Devuelve: Perfil de</p>
</blockquote>
<ul>
<li>fpassthru: Lee toda la información restante desde un puntero hasta el final de un archivo (EOF) y escribe el resultado <strong>en el buffer de salida</strong>. Se puede utilizar <em>rewind()</em> primero para <strong>reiniciar el puntero al principio del archivo</strong> si ya se ha escrito en él. Si simplemente se quiere <strong>verter los contenidos en el búfer de salida sin modificarlo antes</strong> o <strong>buscar un índice concreto</strong>, es mejor usar <em>readfile()</em> y así se evita llamar a <em>fopen()</em>. Devuelve el <strong>número de caracteres</strong> leídos desde <em>$handle</em> y pasados hacia la salida. Esta función no hace falta guardarla en una variable ya que imprime directamente el resultado:</li>
</ul>
<blockquote>
<p>$fp = fopen("miarchivo.txt","r");<br />// Lee la primera línea, que es Esta es la línea 1<br />fgets($fp);<br />// Envía el resto del archívo al output buffer<br />echo fpassthru($fp);<br />/* Devuelve el resto de líneas:<br />Esta es la línea 2<br />Esta es la línea 3<br />Esta es la línea 4<br />Y el número de caracteres: 59, porque hemos hecho echo<br />*/<br />fclose($fp);</p>
<p>Otro ejemplo <strong>devolviendo el index de una página web</strong>:</p>
<p>$fp = fopen("http://www.ejemplo.com", "r");<br />fpassthru($fp);</p>
</blockquote>
<ul>
<li>fgetcsv: Busca <strong>campos en formato csv</strong> en el recurso <em>$handle</em> y devuelve un <em>array</em> conteniéndolos. Se pueden especificar, opcionalmente, la longitud de línea a devolver <em>$length</em>, el delimitador de campo <em>$delimeter</em>, el carácter circundante de cada campo <em>$enclosure</em>, y el carácter de escape <em>$escape</em>.</li>
</ul>
<blockquote>
<p>$fila = 1;<br />if(($fp = fopen("archivo.csv", "r")) !== FALSE) {<br />   while (($datos = fgetcsv($fp)) !== FALSE) {<br />      $numero = count($datos);<br />      echo "Animal de la fila $fila:\n";<br />      $fila++;<br />      for ($i = 0; $i &lt; $numero; $i++){<br />         echo $datos[$i] . "\t";<br />      }<br />      echo "\nFrase: el tipo de animal es {$datos[0]} y se llama {$datos[1]} &lt;br&gt;";<br />   }<br />   fclose($fp);<br />}</p>
</blockquote>
<ul>
<li>fgetc: Obtiene <strong>sólo un carácter</strong> desde un puntero de un archivo. Devuelve el <em><strong>string</strong></em> con el único carácter. Devuelve false si es <strong>EOF</strong>.</li>
</ul>
<blockquote>
<p>if($fp = fopen('miarchivo.txt', 'r')) {<br />   while (false !== ($caracter = fgetc($fp))) {<br />      echo "$caracter\n";<br />   }<br />}</p>
</blockquote>
<ul>
<li>file_get_contents: Devuelve un archivo entero a una cadena, se puede especificar el comienzo desde <em>$offset</em> hasta <em>$maxlen</em>.r Si falla devuelve false, pero genera un E<em>WARNING si </em>$filename<em> no se pudo encontrar, </em>$maxlen<em> es menor que cero o si falla la búsqueda del </em>$offset especificado en el flujo.</li>
</ul>
<blockquote>
<p>// Devuelve el contenido de una web<br />$web = file_get_contents("http://www.ejemplo.com");<br />echo $web;<br />// El código anterior es igual que el siguiente:<br />$fh = fopen("http://www.ejemplo.com", "r");<br />fpassthru($fh);<br />// Devuelve contenido de un archivo en el directorio actual<br />$contenido = file_get_contents("miarchivo.txt");<br />echo $contenido;<br />// Busca dentro de include_path<br />$archivo = file_get_contents('./miarchivo.txt', FILE_USE_INCLUDE_PATH);<br />// Devuelve 20 caracteres desde el carácter 100<br />$articulo = file_get_contents('archivo.txt', NULL, NULL, 100, 20);<br />echo $articulo;</p>
</blockquote>
<ul>
<li>readfile: Es una versión más simplificada de _file_get<em>contents()</em>. Lee un archivo y lo escribe en el <strong>búfer de salida</strong>. La función devuelve el número de <strong>bytes leídos del archivo</strong>.</li>
</ul>
<blockquote>
<p>// Devuelve el contenido de un archivo<br />readfile("miarchivo.txt");<br />// Devuelve el contenido y el número de bytes, 79<br />$contenido = readfile("miarchivo.txt");<br />echo $contenido;</p>
</blockquote>
<ul>
<li>file: Transfiere <strong>un archivo a un array</strong>. Función similar a _file_get<em>contents()</em> pero devuelve los contenidos en un array, donde cada elemento es una línea del archivo. El parámetro opcional flags puede ser una de las siguientes constantes:
<ul>
<li><strong>FILE_USE_INCLUDE_PATH</strong>. Busca el fichero en include_path.</li>
<li><strong>FILE_IGNORE_NEW_LINES</strong>. No se añade una nueva línea al final de cada elemento del array.</li>
<li><strong>FILE_SKIP_EMPTY_LINES</strong>. Salta las líneas vacías.</li>
</ul>
</li>
</ul>
<blockquote>
<p>// Devuelve el contenido en un array:<br />$array = file("miarchivo.txt", FILE_IGNORE_NEW_LINES);<br />var_dump($array);<br />/*<br />   array (size=4)<br />   0 =&gt; string 'Esta es la línea 1' (length=19)<br />   1 =&gt; string 'Esta es la línea 2' (length=19)<br />   2 =&gt; string 'Esta es la línea 3' (length=19)<br />   3 =&gt; string 'Esta es la línea 4' (length=19)<br />*/</p>
</blockquote>
<ul>
<li>parse_ini_file: Analiza el archivo de configuración <em>$filename</em> y devuelve sus configuraciones en un array asociativo. La estructura del fichero es la misma que la del archivo de configuración php.ini. Si _$process<em>sections</em> es true, se obtiene un array multidimensional. Hay dos _$scanner<em>mode</em> : INI_SCANNER NORMAL (por defecto), y INI_SCANNER_RAW. Con este segundo los valores de las opciones no se analizan. La función no guarda ninguna relación con el archivo <em>php.ini</em>, se suele usar para <strong>leer los archivos de configuración de aplicaciones propias</strong>.</li>
</ul>
<blockquote>
<p>// Tenemos en el archivo miarchivo.txt:<br />/*<br />[nombres_animales]<br />perro = Peter<br />gato = Louis<br />conejo = Thug<br />*/<br />$array = parse_ini_file("miarchivo.txt");<br />var_dump($array);<br />/*<br />array (size=3)<br />  'perro' =&gt; string 'Peter' (length=5)<br />  'gato' =&gt; string 'Louis' (length=5)<br />  'conejo' =&gt; string 'Thug' (length=4)<br />*/<br />$array = parse_ini_file("miarchivo.txt", INI_SCANNER_RAW);<br />var_dump($array);<br />/*<br />array (size=1)<br />'nombres_animales' =&gt;<br />array (size=3)<br />'perro' =&gt; string 'Peter' (length=5)<br />'gato' =&gt; string 'Louis' (length=5)<br />'conejo' =&gt; string 'Thug' (length=4)<br />*/</p>
</blockquote>
<ul>
<li>Lectura desde una posición exacta: Podemos llegar exactamente a un punto del archivo con <em><strong>fseek()</strong></em>. Una vez situados en una posición, podemos emplear cualquiera de las funciones anteriores como <em>fgets()</em> o <em>fscanf()</em> para leer los datos:</li>
</ul>
<blockquote>
<p>$fp = fopen("miarchivo.txt", "r");<br />fseek($fp, 28);</p>
<p>while(!feof($fp)){<br />   $linea = fgets($fp);<br />   echo $linea;<br />}<br />fclose($fp);<br />/*<br />la línea 2<br />Esta es la línea 3<br />Esta es la línea 4<br />*/</p>
</blockquote>
<pre><code class="hljs php"><span class="hljs-variable"></span></code></pre></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice" id="id165">
<div class="iDevice emphasis1" >
<header class="iDevice_header iDevice_header_noIcon"><h1 class="iDeviceTitle">5.9.2. Escritura de ficheros</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta165_165_2" class="block iDevice_content">
<div class="exe-text"><ul>
<li>fwrite: Escribe el contenido de <em>$string</em> en el recurso <em>$handle</em>. Si se facilita una longitud <em>$length</em> se escribirá hasta ésta o hasta que acabe <em>$string</em>.Devuelve el <strong>número de bytes</strong> escritos.</li>
</ul>
<blockquote>
<p>$fp = fopen("miarchivo.txt", "w");</p>
<p>fwrite($fp, "Hola que tal");<br />fwrite($fp, ", ¿Cómo estás? \n");</p>
<p>fclose($fp);<br />// Escribirá en miarchivo.txt : Hola que tal, ¿Cómo estás?</p>
<p>En el ejemplo anterior hemos escrito en el archivo de forma que hemos sobreescrito lo anterior (con el <strong>modo w</strong>). Si ahora queremos añadir nuevo contenido al archivo, podemos abrir un recurso con el <strong>modo a de <em>append</em></strong>:</p>
<p>if ($fp = fopen("miarchivo.txt", "a")){<br />   fwrite($fp, "Yo muy bien, ¿Y tú?");<br />}<br />fclose($fp);</p>
<p>La función <em>fputs()</em> es un alias de <em>fwrite()</em>.</p>
</blockquote>
<pre><code class="hljs nginx"></code></pre>
<ul>
<li>file_put_contents: Escribe información <em>$data</em> en un archivo <em>$filename</em>. Viene a ser equivalente a hacer <em>fopen()</em>, <em>fwrite()</em> y <em>fclose()</em> a la vez. Si el archivo <em>$filename</em> no existe, se crea, a no ser que la bandera FILE_APPEND esté establecida. Las banderas pueden ser:
<ul>
<li><strong>FILE_USE_INCLUDE_PATH</strong>. Busca <em>$filename</em> en el directorio _include<em>path</em>.</li>
<li><strong>FILE_APPEND</strong>. Si el archivo <em>$filename</em> ya existe, añade la información en el mismo en lugar de sobreescribirlo.</li>
<li><strong>LOCK_EX</strong>. Adquiere <strong>acceso exclusivo</strong> mientras se ejecuta la escritura. Es como llamar a <a href="http://php.net/manual/es/function.flock.php"><em>flock()</em></a> entre la llamada a <em><strong>fopen()</strong></em> y <em><strong>fwrite()</strong></em>.</li>
</ul>
</li>
</ul>
<blockquote>
<p>La función devuelve el número de bytes escritos en el archivo $filename.</p>
<p>// Uso junto con file_get_contents y añadiendo al ya existente:<br />$archivo = "miarchivo.txt";<br />$actual = file_get_contents($archivo);<br />$actual .= "Esto añade más texto al archivo\n";<br />file_put_contents($archivo, $actual);<br />// Podemos utilizar también la bandera FILE_APPEND para añadir al final sin eliminar:<br />$archivo = "miarchivo.txt";<br />$mascontenido = "¡Todavía más contenido!\n";<br />// También vamos a emplear la bandera LOCK_EX para evitar cualquier modificación mientras:<br />file_put_contents($archivo, $mascontenido, FILE_APPEND | LOCK_EX);</p>
</blockquote>
<ul>
<li>fputcsv: Escribe en <strong>formato csv</strong> en un archivo abierto <em>$handle</em> desde un array <em>$fields</em>.Se puede especificar, opcionalmente, el delimitador de campos <em>$delimeter</em>, un carácter circundante de cada campo <em>$enclosure</em> y un parámetro de escape $escape<em>char</em>. Devuelve la <strong>longitud del string escrito</strong> en cado de éxito o <strong>false</strong> en caso de error.</li>
</ul>
<blockquote>
<p>$animales = array (<br />   array ('tortuga', 'Nicole', '5'),<br />   array ('perro', 'Chukie', '10'),<br />   array ('gato', 'Whiskie', 8)<br />);<br />$fp = fopen('archivo.csv', 'w');<br />foreach ($animales as $row){<br />   fputcsv($fp, $row);<br />}<br />fclose($fp);</p>
</blockquote></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice" id="id161">
<div class="iDevice emphasis1" >
<header class="iDevice_header iDevice_header_noIcon"><h1 class="iDeviceTitle">5.9.3. Punteros de ficheros</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta161_161_2" class="block iDevice_content">
<div class="exe-text"><p>Un <strong>puntero de archivo</strong> (<em>file pointer</em> o <em>handle</em>) es una <strong>variable que hace referencia a un archivo</strong>. Es una variable que <strong>apunta a un archivo en concreto</strong>, y normalmente se obtiene cuando se abre con <em>fopen()</em>.</p>
<p>PHP y su recolección de basuras cierra todos los punteros de archivos al final de la ejecución del script, aunque se considera una buena práctica cerrar los archivos manualmente con <em>fclose()</em>.</p>
<p>Además de apuntar a un archivo, apunta a una <strong>posición concreta en ese archivo</strong>. En la mayoría de los casos cuando se abre un archivo el puntero apunta al principio (posición 0) o al final del archivo.</p>
<p>La función <em>feof()</em> es utilizada con frecuencia en el <strong>manejo de archivos en PHP</strong>. Esta función <strong>comprueba si el puntero se encuentra al final del archivo</strong>. Se utiliza cuando se recorre<strong> un archivo línea por línea</strong> o para la <strong>lectura de grandes archivos</strong>, mediante un condicional:<code class="hljs php"><span class="hljs-variable"></span></code></p>
<blockquote>
<p>$archivo = "miarchivo.txt";<br />// Abrimos el archivo<br />$fp = fopen($archivo, "r");<br />// Loop que parará al final del archivo, cuando feof sea true:<br />while(!feof($fp)){<br />   echo fread($fp, 4092);<br />}<code class="hljs php">
</code></p>
</blockquote>
<p>El código anterior sólo cargará 4kb de datos de vez, lo que reduce el uso de memoria para grandes archivos.</p>
<p><strong>Seeking</strong> es mover el puntero de un archivo. Para mover el puntero se puede usar la función <em>fseek()</em>, y para encontrar la posición de un puntero dado <em>ftell()</em>. Vamos a ver algunos ejemplos:</p>
<blockquote>
<p>$file = "miarchivo.txt";<br />$texto = "Hola que tal 12345";<br />$fp = fopen($file, "w");<br />fwrite($fp, $texto);<br />fclose($fp);</p>
</blockquote>
<p>Ahora abriremos el archivo para ir viendo <em>fseek</em> y <em>ftell</em>:</p>
<blockquote>
<p>$fp = fopen($file, "r");<br />// Si lo hemos abierto con r, siempre empieza desde el principio:<br />echo ftell($fp) . "&lt;br&gt;"; // Devuelve 0<br />// Colocamos el apuntador en la posicion 10:<br />fseek($fp, 10);<br />// Mostramos la posición actual:<br />echo ftell($fp) . "&lt;br&gt;"; // Devuelve 10<br />// Se puede indicar una posición sin contenido:<br />fseek($fp, 1000);<br />echo ftell($fp) . "&lt;br&gt;"; // Devuelve 1000<br />// Para ir al final del archivo se emplea un tercer argumento en fseek:<br />fseek($fp, 0, SEEK_END);<br />echo ftell($fp) . "&lt;br&gt;"; // Devuelve 18<br />// Para mover el apuntador a una posición relativa se emplea SEEK_CUR:<br />fseek($fp, -5, SEEK_CUR);<br />echo ftell($fp) . "&lt;br&gt;"; // Devuelve 13</p>
</blockquote>
<p>No es necesario emplear <em>fseek()</em> para mover el puntero, también se puede hacer cuando se lee o se escribe un archivo:</p>
<blockquote>
<p>// Cambiar el puntero leyendo un archivo:<br />$file = "miarchivo.txt";<br />$fp = fopen($file, "r");<br />// Leemos 10 bytes<br />$datos = fread($fp, 10);<br />echo ftell($fp); // Devuelve 10<br />// Cambiar el puntero escribiendo un archivo:<br />$file = "miarchivo.txt";<br />$texto = "12345";<br />$fp = fopen($file, "w");<br />// Escribimos los 5 bytes del texto:<br />fwrite($fp, $texto);<br />echo ftell($fp); // Devuelve 5</p>
</blockquote></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice" id="id162">
<div class="iDevice emphasis1" >
<header class="iDevice_header iDevice_header_noIcon"><h1 class="iDeviceTitle">5.9.4. Obtener información de ficheros</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta162_162_2" class="block iDevice_content">
<div class="exe-text"><p>Se puede <strong>obtener información de un archivo</strong> además de su <strong>contenido</strong>: tamaño, última vez que se ha accedido o modificado, número de links, etc. La función principal para obtener esta información es con la función <em>stat()</em>, en esta tabla se pueden ver los 12 elementos que devuelve el <em>array</em>.</p>
<blockquote>
<p>$file = "miarchivo.txt";<br />$texto = "Todos somos muy ignorantes, lo que ocurre es que no todos ignoramos las mismas cosas.";</p>
<p>$fp = fopen($file, "w");<br />fwrite($fp, $texto);</p>
<p>$datos = stat($file);</p>
<p>echo $datos[3] . "&lt;br&gt;"; // Número de enlaces, 1<br />echo $datos[7] . "&lt;br&gt;"; // Tamaño en bytes, 85<br />echo $datos[8] . "&lt;br&gt;"; // Momento de último acceso, 1444138104<br />echo $datos[9] . "&lt;br&gt;"; // Momento de última modificación, 1444138251</p>
</blockquote>
<p>La extensión fileinfo de <strong>PHP</strong> ofrece también una serie de <strong>funciones para obtener información de archivos</strong>. Primero se crea un <em>recurso</em> con la función <strong>finfo_open()</strong><em> o la </em><strong>clase finfo()</strong>, con la configuración que se especifique, y después se utiliza finfo_file() o finfo::file() para obtener la información:</p>
<pre><code class="hljs php"></code></pre>
<pre><code class="hljs php"><span class="hljs-variable"></span></code></pre>
<pre><code class="hljs php"><span class="hljs-variable"></span></code></pre>
<ul>
<li>finfo_open. Crea un <strong>recurso fileinfo</strong>, abre una base de datos mágica y la devuelve a su recurso. _$magic<em>file</em> es opcional, es el archivo de la base de datos mágica. El primer argumento, <em>$options</em>, es una <strong>constante de fileinfo</strong>, también opcional. Puedes obtener la lista entera de constantes fileinfo.</li>
</ul>
<ul>
<li>finfo_file. El argumento <em>$finfo</em> es el recurso que se ha creado con _finfo<em>open</em>. _$file<em>name</em> el archivo del que se quiere obtener información.</li>
</ul>
<blockquote>
<p>$file = "miarchivo.txt";<br />$finfo = new finfo(FILEINFO_MIME); // Devuelve el tipo mime<br />echo $finfo-&gt;file($file); // Devuelve: text/plain; charset=us-ascii</p>
</blockquote>
<p>Para <strong>cerrar un recurso fileinfo abierto</strong> se utiliza finfo_close().</p></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice" id="id163">
<div class="iDevice emphasis1" >
<header class="iDevice_header iDevice_header_noIcon"><h1 class="iDeviceTitle">5.9.5. Directorios</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta163_163_2" class="block iDevice_content">
<div class="exe-text"><p>Las funciones de directorios vienen de la extensión directories de <strong>PHP</strong>. Hay un total de 9 funciones disponibles:</p>
<ul>
<li>chdir. Cambia el directorio actual al directorio <em>$directory</em>.</li>
</ul>
<ul>
<li>getcwd. Obtiene el directorio actual.</li>
</ul>
<blockquote>
<p>echo getcwd() . "\n"; // Directorio: /directorio/actual<br />chdir('nuevo/directorio');<br />echo getcwd() . "\n"; // Directorio: /directorio/actual/nuevo/directorio</p>
</blockquote>
<ul>
<li>scandir. Devuelve un <em>array</em> con los archivos y directorios que se encuentran en <em>$directory</em>. El _$sorting<em>order</em> indica el orden en que devolverá el listado: <strong>SCANDIR_SORT_ASCENDING (0), SCANDIR_SORT_DESCENDING (1) o SCANDIR_SORT_NONE</strong> (sin orden):</li>
</ul>
<blockquote>
<p>$directorio = "Slim";<br />$archivos = scandir($directorio, 1);<br />print_r($archivos);<br />/*<br />Array<br />(<br />   [0] =&gt; View.php<br />   [1] =&gt; Slim.php<br />   [2] =&gt; Router.php<br />   [3] =&gt; Middleware<br />   [4] =&gt; LogWriter.php<br />   [5] =&gt; Log.php<br />   [6] =&gt; Http<br />   [7] =&gt; Helper<br />   [8] =&gt; Environment.php<br />   [9] =&gt; ..<br />   [10] =&gt; .<br />)<br />*/</p>
</blockquote>
<ul>
<li>chroot. Cambia el directorio raíz al directorio <em>$directory</em>. Requiere privilegios de administrador. Es necesario tener en cuenta que el directorio que se señale ha de estar preparado incluyendo los archivos necesarios para ser un directorio root.</li>
</ul>
<ul>
<li>opendir. Abre un <strong>gestor de directorio</strong> para ser usado en llamadas posteriores como <em>closedir()</em>, <em>readdir()</em> y <em>rewinddir()</em>.</li>
</ul>
<ul>
<li>readdir. Lee una entrada desde un gestor de directorio. _$dir<em>handle</em> es el gestor de directorio previamente abierto por <em>opendir().</em> Si no se especifica se usa la última conexión abierta por <em>opendir()</em>. Devuelve el nombre de la siguiente entrada del directorio.</li>
</ul>
<ul>
<li>closedir. Cierra un gestor de directorio abierto _$dir<em>handle</em>. Si no se especifica se asumirá la última conexión abierta por <em>opendir()</em>.</li>
</ul>
<p>Ejemplo de las funciones <em>opendir</em>, <em>readdir</em> y <em>closedir</em>:</p>
<blockquote>
<p>if ($gestor = opendir('Slim')) {<br />   echo "Gestor de directorio: $gestor\n";<br />   echo "Entradas:\n";<br />   // Iteramos sobre el directorio:<br />   while (false !== ($entrada = readdir($gestor))) {<br />      echo "$entrada\n";<br />   }<br />   closedir($gestor);<br />}<br />// Devuelve todos los archivos del directorio especificado</p>
</blockquote>
<ul>
<li>rewinddir. Restablece la secuencia de directorio indicada por _$dir<em>handle</em> al comienzo del directorio. De nuevo, si no se especifica el gestor, se asumirá la última conexión abierta por <em>opendir()</em>.</li>
</ul></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice" id="id166">
<div class="iDevice emphasis1" >
<header class="iDevice_header iDevice_header_noIcon"><h1 class="iDeviceTitle">5.9.6. Funciones del sistema de ficheros</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta166_166_2" class="block iDevice_content">
<div class="exe-text"><p><span style="font-size: 12pt;">Las funciones del sistema de archivos que existen en la extensión filesystem de PHP se han agrupado en cuatro grupos básicos: directorios, modificación, información, comprobación y enlaces. No se incluyen funciones de las secciones anteriores para el manejo de archivos.</span></p>
<p><span style="font-size: 12pt;"><strong>Indice de contenido</strong></span></p>
<ol>
<li><span style="font-size: 12pt;">Funciones de directorios</span></li>
<li><span style="font-size: 12pt;">Funciones de modificación de archivos</span></li>
<li><span style="font-size: 12pt;">Funciones de información de archivos</span></li>
<li><span style="font-size: 12pt;">Funciones de comprobación de archivos</span></li>
<li><span style="font-size: 12pt;">Funciones de enlaces</span></li>
</ol>
<h3><span style="font-size: 12pt;">1. Funciones de directorios</span></h3>
<ul>
<li><span style="font-size: 12pt;">basename</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">string</span> basename (string <span class="hljs-variable">$path</span> [, string <span class="hljs-variable">$suffix</span> ])</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Devuelve el último componente de una ruta o directorio. El parámetro <em>$suffix</em> permite excluir parte del componente a devolver.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$directorio</span> = <span class="hljs-string">"este/es/un/directorio/cualquiera.csv"</span>;
<span class="hljs-keyword">echo</span> basename(<span class="hljs-variable">$directorio</span>, <span class="hljs-string">'.csv'</span>); <span class="hljs-comment">// Devuelve cualquiera</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">dirname</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">_string_</span> **dirname (**_string_ **<span class="hljs-variable">$path</span>****)**</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Devuelve la ruta de un directorio padre.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$directorio</span> = <span class="hljs-string">"este/es/un/directorio/cualquiera.csv"</span>;
<span class="hljs-keyword">echo</span> dirname(<span class="hljs-variable">$directorio</span>); <span class="hljs-comment">// este/es/un/directorio</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">pathinfo</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">mixed</span> pathinfo (string <span class="hljs-variable">$path</span> [, int <span class="hljs-variable">$options</span> = PATHINFO_DIRNAME | PATHINFO_BASENAME | PATHINFO_EXTENSION | PATHINFO_FILENAME ])</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Devuelve <strong>información sobre la ruta de un archivo</strong>. Devuelve <em>string</em> si sólo se indica una opción de <em>$options</em>, o un <em>array</em> si se solicitan todas.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$directorio</span> = <span class="hljs-string">"este/es/un/directorio/cualquiera.csv"</span>;
var_dump(pathinfo(<span class="hljs-variable">$directorio</span>));
<span class="hljs-comment">/*
array (size=4)
  'dirname' =&gt; string 'este/es/un/directorio' (length=21)
  'basename' =&gt; string 'cualquiera.csv' (length=14)
  'extension' =&gt; string 'csv' (length=3)
  'filename' =&gt; string 'cualquiera' (length=10)
*/</span>
var_dump(pathinfo(<span class="hljs-variable">$directorio</span>, PATHINFO_DIRNAME));
<span class="hljs-comment">/*
string 'este/es/un/directorio' (length=21)
*/</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">realpath</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">_string_</span> **realpath (**_string_ **<span class="hljs-variable">$path</span>)**</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Devuelve el <strong>nombre de la ruta absoluta canonizada</strong>. Expande los enlaces simbólicos y remueve los caracteres '/./', '/../' y '/' extra. No funciona en rutas que no existen.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$directorio</span> = <span class="hljs-string">'../slimproject/Slim/Helper/'</span>;
<span class="hljs-keyword">echo</span> realpath(<span class="hljs-variable">$directorio</span>); <span class="hljs-comment">// /Users/usuario/Sites/slimproject/Slim/Helper</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">mkdir</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> mkdir (string <span class="hljs-variable">$pathname</span> [, int <span class="hljs-variable">$mode</span> = <span class="hljs-number">0777</span> [, bool <span class="hljs-variable">$recursive</span> = <span class="hljs-built_in">false</span> [, resource <span class="hljs-variable">$context</span> ]]] )</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Crea el directorio especificado por <em>$pathname</em>. <em>$mode</em> indica los permisos de acceso que tendrá el directorio. <em>$recursive</em> permite la creación de directorios anidados, especificados desde <em>$pathname</em>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$directorio</span> = <span class="hljs-string">'NuevaCarpeta/Otra/Yotra'</span>;
mkdir(<span class="hljs-variable">$directorio</span>, <span class="hljs-number">0777</span>, <span class="hljs-keyword">true</span>); <span class="hljs-comment">// Ha creado desde el directorio actual 3 carpetas recursivas</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">rmdir</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> rmdir (string <span class="hljs-variable">$dirname</span> [, resource <span class="hljs-variable">$context</span> ])</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Elimina el directorio <em>$dirname</em>. El directorio tiene que estar vacío, y los permisos relevantes deben permitirlo.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$directorio</span> = <span class="hljs-string">'MiCarpeta'</span>;
rmdir(<span class="hljs-variable">$directorio</span>); <span class="hljs-comment">// Eliminada MiCarpeta</span></code></span></pre>
<h3><span style="font-size: 12pt;">2. Funciones de modificación de archivos</span></h3>
<ul>
<li><span style="font-size: 12pt;">copy</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> copy (strong <span class="hljs-variable">$source</span>, string <span class="hljs-variable">$dest</span> [, resource <span class="hljs-variable">$context</span> ])</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Copia el archivo <em>$source</em> al destino <em>$dest</em>. Ambas son rutas, por lo que deben incluir el directorio (si es distinto del actual) y el nombre del archivo. Para mover un fichero se usa <em>rename()</em>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$destino</span> = <span class="hljs-string">"MiCarpeta/micopiadearchivo.txt"</span>;
copy(<span class="hljs-string">"miarchivo.txt"</span>, <span class="hljs-variable">$destino</span>);</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">unlink</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> unlink (string <span class="hljs-variable">$filename</span> [, resource <span class="hljs-variable">$context</span> ]) </code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Elimina el archivo <em>$filename</em>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php">unlink(<span class="hljs-string">"MiCarpeta/micopiadearchivo.txt"</span>);
</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">rename</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> rename (string <span class="hljs-variable">$oldname</span>, string <span class="hljs-variable">$newname</span> [, resource <span class="hljs-variable">$context</span> ])</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Renombra <em>$oldname</em> a <em>$newname</em>, moviéndolo a otro directorio si es necesario. Si <em>$newname</em> ya existe, lo sobreescribirá.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"miarchivo.txt"</span>;
rename (<span class="hljs-variable">$archivo</span>, <span class="hljs-string">"esmiarchivo.txt"</span>);</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">move_uploaded_file</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> move_uploaded_file (string <span class="hljs-variable">$filename</span>, string <span class="hljs-variable">$destination</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Mueve un archivo subido <em>$filename</em> a una ubicación <em>$destination</em>. La función se asegura de que <strong>el archivo subido es válido</strong> (es válido si se ha subido mediante un <strong>mecanismo de subida HTTP POST de PHP</strong>), si es así, lo mueve al nombre de archivo dado por <em>$destination</em>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'submit'</span>])){
    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">'file_upload'</span>];
    <span class="hljs-variable">$directorio_temporal</span> = <span class="hljs-variable">$file</span>[<span class="hljs-string">'tmp_name'</span>];
    <span class="hljs-variable">$nombre_archivo</span> = basename(<span class="hljs-variable">$file</span>[<span class="hljs-string">'name'</span>]);
    <span class="hljs-variable">$directorio_objetivo</span> = <span class="hljs-string">"/uploads/"</span>. <span class="hljs-variable">$nombre_archivo</span>;

    <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$directorio_temporal</span>, <span class="hljs-variable">$directorio_objetivo</span>)) {
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Archivo subido correctamente"</span>;
    }
}</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">rewind</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> rewind (resource <span class="hljs-variable">$handle</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Establece el puntero de un archivo del recurso <em>$handle</em> al principio. Si el archivo se ha abierto en <strong>modo adición</strong> como <strong>a</strong> o <strong>a+</strong>, cualquier información que se escriba en el archivo irá siempre al final, no importa la posición del puntero.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-comment">// Contenido de archivo.txt: Hola, ¿Qué tal?</span>
<span class="hljs-variable">$gestor</span> = fopen(<span class="hljs-string">'archivo.txt'</span>, <span class="hljs-string">'r+'</span>);
<span class="hljs-comment">// Añadimos Hey! , al principio</span>
fwrite(<span class="hljs-variable">$gestor</span>, <span class="hljs-string">"Wey!, "</span>);
<span class="hljs-comment">// Volvemos al inicio</span>
rewind(<span class="hljs-variable">$gestor</span>);
<span class="hljs-comment">// Añadimos Hey!, al principio</span>
fwrite(<span class="hljs-variable">$gestor</span>, <span class="hljs-string">"Hey!, "</span>);
<span class="hljs-comment">// Si no hacemos este rewind de nuevo, al llamar a fgets, comenzará</span>
<span class="hljs-comment">// a leer desde el final del anterior fwrite()</span>
rewind(<span class="hljs-variable">$gestor</span>);

<span class="hljs-keyword">echo</span> fgets(<span class="hljs-variable">$gestor</span>); <span class="hljs-comment">// Devuelve Hey!, ¿Qué tal?</span>

fclose(<span class="hljs-variable">$gestor</span>);</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">flock</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> flock (resource <span class="hljs-variable">$handle</span>, int <span class="hljs-variable">$operation</span> [, int &amp;<span class="hljs-variable">$wouldblock</span> ])</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Permite <strong>bloquear un archivo</strong> del resource <em>$handle</em>. Bloquear un archivo evita que pueda ser accedido a la vez desde diferentes scripts. El <strong>bloqueo</strong> sólo actúa en el <strong>proceso PHP actual</strong>, otros procesos pueden modificar o eliminar un archivo bloqueado si se tienen los permisos necesarios.</span></p>
<p><span style="font-size: 12pt;">El parámetro <em>$operation</em> permite especificar el tipo de bloqueo:</span></p>
<p><span style="font-size: 12pt;"><strong>LOCK_SH</strong>. Bloqueo compartido (lectura).</span></p>
<p><span style="font-size: 12pt;"><strong>LOCK_EX</strong>. Bloqueo exclusivo (escritura).</span></p>
<p><span style="font-size: 12pt;"><strong>LOCK_UN</strong>. Libera un bloqueo, compartido o exclusivo.</span></p>
<p><span style="font-size: 12pt;">También se puede añadir LOCK_NB a una de las operaciones anteriores si no se quiere que flock() espere hasta que obtiene el bloqueo.</span></p>
<p><span style="font-size: 12pt;">Si parámetro opcional <em>$wouldblock</em> es 1 el bloqueo hará que otros procesos de la función queden en espera.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-variable">$fp</span> = fopen(<span class="hljs-variable">$archivo</span>, <span class="hljs-string">'r+'</span>);

<span class="hljs-keyword">if</span>(flock(<span class="hljs-variable">$fp</span>, LOCK_EX)){ <span class="hljs-comment">// Inicia el bloqueo exclusivo</span>
    ftruncate(<span class="hljs-variable">$fp</span>, <span class="hljs-number">0</span>);
    fwrite(<span class="hljs-variable">$fp</span>, <span class="hljs-string">"Texto nuevo del archivo\n"</span>);
    fflush(<span class="hljs-variable">$fp</span>); <span class="hljs-comment">// Vuelca la salida antes de liberar el bloqueo</span>
    flock(<span class="hljs-variable">$fp</span>, LOCK_UN);<span class="hljs-comment">// Libera el bloqueo</span>
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"No se pudo bloquear"</span>;
}
fclose(<span class="hljs-variable">$fp</span>);</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">ftruncate</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> ftruncate (resource <span class="hljs-variable">$handle</span>, int <span class="hljs-variable">$size</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Trunca un archivo en <em>$handle</em> a la longitud <em>$size</em>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-comment">// Contenido de archivo.txt: Hola que tal</span>
<span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-variable">$fp</span> = fopen(<span class="hljs-variable">$archivo</span>, <span class="hljs-string">'r+'</span>);
ftruncate(<span class="hljs-variable">$fp</span>, rand(<span class="hljs-number">1</span>, filesize(<span class="hljs-variable">$archivo</span>)));
<span class="hljs-keyword">echo</span> fread(<span class="hljs-variable">$fp</span>, filesize(<span class="hljs-variable">$archivo</span>)); <span class="hljs-comment">// Contenido final: Hola que</span>
fclose(<span class="hljs-variable">$fp</span>);
</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">tempnam</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">_string_</span> **tempnam (**_string_ **<span class="hljs-variable">$dir</span>,** _string_ **<span class="hljs-variable">$prefix</span>)**</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Crea un archivo con un nombre de archivo único, cuyo <strong>permiso de acceso se establece a 0600</strong> en el directorio <em>$dir</em>. Si el directorio no existe o no es escribible, <em>tempnam()</em> puede generar un archivo en el directorio temporal del sistema, y devolver la ruta completa del archivo, incluyendo su nombre. <em>$prefix</em> establece el prefijo del nombre del archivo.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = tempnam(<span class="hljs-string">"MiCarpeta"</span>, <span class="hljs-string">"hola"</span>);

<span class="hljs-variable">$fp</span> = fopen(<span class="hljs-variable">$archivo</span>, <span class="hljs-string">"w"</span>);
fwrite(<span class="hljs-variable">$fp</span>, <span class="hljs-string">"Texto que irá al archivo nuevo temporal"</span>);
fclose(<span class="hljs-variable">$fp</span>);

<span class="hljs-comment">// Realizar alguna acción</span>

<span class="hljs-comment">// Borrar el archivo:</span>
unlink(<span class="hljs-variable">$archivo</span>);</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">tmpfile</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">resource</span> tmpfile (void)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Crea un <strong>archivo temporal de nombre único</strong> en modo lectura-escritura (w+) y <strong>devuelve un gestor de archivo</strong>. El archivo se elimina cuando se cierra (con <em><strong>fclose()</strong></em>, cuando no quedan referencias al gestor de ficheros devuelto o cuando el script finaliza).</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$temporal</span> = tmpfile();
fwrite(<span class="hljs-variable">$temporal</span>, <span class="hljs-string">"Texto en el archivo temporal"</span>);
fseek(<span class="hljs-variable">$temporal</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// También podría usarse rewind()</span>
<span class="hljs-keyword">echo</span> fread(<span class="hljs-variable">$temporal</span>, <span class="hljs-number">100</span>);
fclose(<span class="hljs-variable">$temporal</span>);</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">touch</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> touch (string <span class="hljs-variable">$filename</span> [, int <span class="hljs-variable">$time</span> = time() [, int <span class="hljs-variable">$atime</span> ]] )</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Establece momentos de acceso y modificación del archivo <em>$filename</em>. Si el archivo no existe, se crea. <em>$time</em> es el momento de modificación, si no se proporciona, se emplea la hora actual del sistema. <em>$atime</em> es el momento de acceso, si no existe, se toma el valor de <em>$time</em>. Si ninguno de los dos existen, se toma el valor actual del sistema.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$momento</span> = time() - <span class="hljs-number">1800</span>;

<span class="hljs-keyword">if</span>(touch(<span class="hljs-string">'archivo.txt'</span>, <span class="hljs-variable">$momento</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Archivo afectado correctamente"</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Error"</span>;
}</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">chown</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> chown (string <span class="hljs-variable">$filename</span>, mixed <span class="hljs-variable">$user</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Cambia el propietario de un archivo a <em>$user</em>. Sólo puede hacerlo un <strong>superusuario</strong>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>; <span class="hljs-comment">// Ruta al archivo</span>
<span class="hljs-variable">$usuario</span> = <span class="hljs-string">"root"</span>;
<span class="hljs-comment">// Establecemos usuario</span>
chown(<span class="hljs-variable">$archivo</span>, <span class="hljs-variable">$usuario</span>);

<span class="hljs-variable">$stats</span> = stat(<span class="hljs-variable">$archivo</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$stats</span>[<span class="hljs-number">4</span>];</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">chmod</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> chmod (string <span class="hljs-variable">$filename</span>, mixed <span class="hljs-variable">$mode</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Cambia el modo de un archivo a <em>$mode</em>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-comment">// Es necesario prefijar el modo con un 0</span>
chmod(<span class="hljs-string">"MiCarpeta/archivo.txt"</span>, <span class="hljs-number">755</span>); <span class="hljs-comment">// Mal</span>
chmod(<span class="hljs-string">"MiCarpeta/archivo.txt"</span>, <span class="hljs-string">"u+rwx, go+rx"</span>); <span class="hljs-comment">// Mal</span>
chmod(<span class="hljs-string">"MiCarpeta/archivo.txt"</span>, <span class="hljs-number">0755</span>); <span class="hljs-comment">// CORRECTO</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">chgrp</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> chgrp (string <span class="hljs-variable">$filename</span>, mixed <span class="hljs-variable">$group</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Cambia el grupo de un archivo a <em>$group</em>. Sólo el superusuario puede cambiarlo a cualquier grupo, los demás usuarios lo pueden cambiar por grupos del que ellos sean miembro.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php">chmod(<span class="hljs-string">"MiCarpeta/archivo.txt"</span>, <span class="hljs-number">8</span>); <span class="hljs-comment">// Cambiado de grupo</span></code></span></pre>
<h3><span style="font-size: 12pt;">3. Funciones de información de archivos</span></h3>
<ul>
<li><span style="font-size: 12pt;">fileatime</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">int</span> fileatime (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Obtiene el momento del <strong>último acceso a un archivo</strong>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;

<span class="hljs-keyword">if</span>(file_exists(<span class="hljs-variable">$archivo</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"última modificación a $archivo: "</span>. date(<span class="hljs-string">"D d Y H:i:s"</span>, fileatime(<span class="hljs-variable">$archivo</span>));
} <span class="hljs-comment">// Devuelve: última modificación a archivo.txt: Thu 08 2015 11:12:26</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">filectime</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">int</span> filectime (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Obtiene el <strong>momento del último cambio del i-nodo de un archivo</strong>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;

<span class="hljs-keyword">if</span>(file_exists(<span class="hljs-variable">$archivo</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"último acceso a $archivo: "</span>. date(<span class="hljs-string">"D d Y H:i:s"</span>, filectime(<span class="hljs-variable">$archivo</span>));
} <span class="hljs-comment">// Devuelve: último acceso a archivo.txt: Thu 08 2015 11:12:24</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">filemtime</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">int</span> filemtime (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Obtiene el <strong>momento de la última modificación de un archivo</strong>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;

<span class="hljs-keyword">if</span>(file_exists(<span class="hljs-variable">$archivo</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"última modificación a $archivo: "</span>. date(<span class="hljs-string">"D d Y H:i:s"</span>, filemtime(<span class="hljs-variable">$archivo</span>));
} <span class="hljs-comment">// Devuelve: última modificación a archivo.txt: Thu 08 2015 11:42:24</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">fileowner</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">int</span> fileowner (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Obtiene el <strong>propietario</strong> de un archivo.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-keyword">echo</span> fileowner(<span class="hljs-variable">$archivo</span>);</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">fileperms</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">int</span> fileperms (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Obtiene los <strong>permisos de un archivo</strong>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-comment">/*
 Si sólo se usa fileperms(), devuelve un número que incluye los permisos
e información del archivo dado. Para devolver exactamente los permisos en formato
octal como en chmod(), se utiliza la siguiente expresión:
 */</span>
<span class="hljs-keyword">echo</span> substr(sprintf(<span class="hljs-string">'%o'</span>, fileperms(<span class="hljs-variable">$archivo</span>)), -<span class="hljs-number">4</span>);</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">filegroup</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">int</span> filegroup (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Obtiene el <strong>grupo de un archivo</strong>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-keyword">echo</span> filegroup(<span class="hljs-variable">$archivo</span>);</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">filesize</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">int</span> filesize (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Obtiene el <strong>tamaño</strong> de un archivo. Devuelve el tamaño en <strong>bytes</strong>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-keyword">echo</span> filesize(<span class="hljs-variable">$archivo</span>);</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">filetype</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">_string_</span> **filetype (**_string_ **<span class="hljs-variable">$filename</span>)**</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Obtiene el <strong>tipo de archivo</strong>. Los valores que puede devolver son: fifo, char, dir, block, link, file, socket y unknown.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-keyword">echo</span> filetype(<span class="hljs-variable">$archivo</span>); <span class="hljs-comment">// file</span></code></span></pre>
<h3><span style="font-size: 12pt;">4. Funciones de comprobación de archivos</span></h3>
<ul>
<li><span style="font-size: 12pt;">file_exists</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> file_exists (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Comprueba si existe el <strong>archivo</strong> o <strong>directorio</strong> <em>$filename</em>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;

<span class="hljs-keyword">if</span>(file_exists(<span class="hljs-variable">$archivo</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"El archivo $archivo existe"</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"El archivo $archivo no existe"</span>;
}</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">is_file</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> is_file (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Indica si el archivo <em>$filename</em> es del tipo <em><strong>file</strong></em> (un archivo normal).</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;

<span class="hljs-keyword">if</span>(is_file(<span class="hljs-variable">$archivo</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"El archivo $archivo existe y es del tipo file"</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"El archivo $archivo no existe o no es del tipo file"</span>;
}</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">is_dir</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> is_dir (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Indica si <em>$filename</em> es un directorio.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$directorio</span> = <span class="hljs-string">"MiCarpeta"</span>;

<span class="hljs-keyword">if</span>(is_dir(<span class="hljs-variable">$directorio</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"El directorio $directorio existe"</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"El directorio $directorio no existe"</span>;
}</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">is_link</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> is_link (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Indica si <em>$filename</em> es un enlace simbólico.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$enlace</span> = <span class="hljs-string">"archy"</span>;

<span class="hljs-keyword">if</span>(is_link(<span class="hljs-variable">$enlace</span>)){
    <span class="hljs-keyword">echo</span> (readlink(<span class="hljs-variable">$enlace</span>));
} <span class="hljs-keyword">else</span> {
    symlink(<span class="hljs-string">'archivo.txt'</span>, <span class="hljs-variable">$enlace</span>);
}</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">is_executable</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> is_executable (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Indica si el archivo <em>$filename</em> es ejecutable.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"miarchivo.sh"</span>;

<span class="hljs-keyword">if</span>(is_executable(<span class="hljs-variable">$archivo</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"$archivo es ejecutable"</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"$archivo no es ejecutable"</span>;
}</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">is_readable</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> is_readable (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Indica si el archivo <em>$filename</em> existe y es legible.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;

<span class="hljs-keyword">if</span>(is_readable(<span class="hljs-variable">$archivo</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"$archivo es legible"</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"$archivo no es legible"</span>;
}</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">is_writable</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> is_writable (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Devuelve <strong>true</strong> si <em>$filename</em> existe y es escribible. Puede ser también un directorio.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;

<span class="hljs-keyword">if</span>(is_writable(<span class="hljs-variable">$archivo</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"$archivo es escribible"</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"$archivo no es escribible"</span>;
}</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">is_uploaded_file</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> is_uploaded_file (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Devuelve <strong>true</strong> si el archivo <em>$filename</em> fue subido mediante HTTP POST. Es útil en términos de seguridad para asegurarse de que el archivo con el que se trabaja es el subido con ese método. Para que funcione correctamente necesita el argumento con el nombre que se le ha puesto en el servidor: _<strong>$_FILES['archivo']['tmp_name']</strong><em>, no funciona con el nombre del usuario: </em><strong>$_FILES['archivo']['name']</strong>_.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">'archivo'</span>][<span class="hljs-string">'tmp_name'</span>];

<span class="hljs-keyword">if</span>(is_uploaded_file(<span class="hljs-variable">$file</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"El archivo se ha subido mediante HTTP POST"</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"El archivo no se ha subido mediante HTTP POST"</span>;
}</code></span></pre>
<h3><span style="font-size: 12pt;">5. Funciones de enlaces</span></h3>
<ul>
<li><span style="font-size: 12pt;">symlink</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> symlink (string <span class="hljs-variable">$target</span>, string <span class="hljs-variable">$link</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Crea un <strong>enlace simbólico</strong> a <em>$target</em> con el nombre <em>$link</em>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-variable">$link</span> = <span class="hljs-string">"archy"</span>;
symlink(<span class="hljs-variable">$archivo</span>, <span class="hljs-variable">$link</span>);

<span class="hljs-keyword">echo</span> readlink(<span class="hljs-variable">$link</span>); <span class="hljs-comment">// archivo.txt</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">readlink</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">_string_</span> **readlink (**_string_ **<span class="hljs-variable">$path</span>)**</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Devuelve el objetivo de un <strong>enlace simbólico</strong>. Se puede ver en el ejemplo anterior.</span></p>
<ul>
<li><span style="font-size: 12pt;">link</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> link ( string <span class="hljs-variable">$target</span>, string <span class="hljs-variable">$link</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Crea un <strong>enlace hard</strong> a <em>$target</em>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-variable">$link</span> = <span class="hljs-string">"arc"</span>;
var_dump(link(<span class="hljs-variable">$archivo</span>, <span class="hljs-variable">$link</span>)); <span class="hljs-comment">// boolean true</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">linkinfo</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">int</span> linkinfo (string <span class="hljs-variable">$path</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Obtiene información acerca de un <strong>enlace</strong>. Sirve para verificar si un enlace <strong>existe</strong> realmente.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-variable">$link</span> = <span class="hljs-string">"archy"</span>;
<span class="hljs-keyword">echo</span> linkinfo(<span class="hljs-variable">$link</span>);<span class="hljs-comment">//Devuelve el campo st_dev de C en Unix:</span>
<span class="hljs-comment">// 16777218</span></code></span></pre>
<ul>
<li><span style="font-size: 12pt;">lstat</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">array</span> lstat (string <span class="hljs-variable">$filename</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Proporciona información acerca de un <strong>archivo</strong> o <strong>enlace simbólico</strong>. Función idéntica a <em>stat()</em>, excepto que si el parámetro <em>$filename</em> es un enlace simbólico, devuelve el <strong>estado</strong> del mismo <strong>enlace simbólico</strong>. En cambio, <em>stat()</em> devolverá el estado del archivo aunque se le proporcione el enlace simbólico.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-variable">$link</span> = <span class="hljs-string">"archy"</span>;
var_dump(lstat(<span class="hljs-variable">$link</span>));</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">lchown</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> lchown (string <span class="hljs-variable">$filename</span>, mixed <span class="hljs-variable">$user</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Cambia el <strong>propietario</strong> de un <strong>enlace simbólico</strong>.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-variable">$link</span> = <span class="hljs-string">"archy"</span>;
symlink(<span class="hljs-variable">$archivo</span>, <span class="hljs-variable">$link</span>);

lchown(<span class="hljs-variable">$link</span>, <span class="hljs-number">8</span>);</code></span></pre>
<ul>
<li><span style="font-size: 12pt;">lchgrp</span>
<pre><span style="font-size: 12pt;"><code class="hljs nginx"><span class="hljs-title">bool</span> lchgrp (string <span class="hljs-variable">$filename</span>, mixed <span class="hljs-variable">$group</span>)</code></span></pre>
</li>
</ul>
<p><span style="font-size: 12pt;">Cambia el <strong>grupo</strong> de un <strong>enlace simbólico</strong>. Sólo el <strong>superusuario</strong> puede cambiarlo a cualquier grupo, los demás usuarios lo pueden cambiar por grupos del que ellos sean miembro.</span></p>
<pre><span style="font-size: 12pt;"><code class="hljs php"><span class="hljs-variable">$archivo</span> = <span class="hljs-string">"archivo.txt"</span>;
<span class="hljs-variable">$link</span> = <span class="hljs-string">"archy"</span>;
symlink(<span class="hljs-variable">$archivo</span>, <span class="hljs-variable">$link</span>);

lchgrp(<span class="hljs-variable">$link</span>, <span class="hljs-number">8</span>);</code></span></pre></div>
</div>
</div>
</div>
</div>
</article>
<div id="packageLicense" class="cc cc-by-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Licencia Creative Commons Reconocimiento Compartir igual 4.0</a></p>
</div>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="58_xml.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="510_encriptacin_y_contraseas.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
</div>
<p id="made-with-eXe"><a href="https://exelearning.net/" target="_blank" rel="noopener"><span>Creado con eXeLearning<span> (Ventana nueva)</span></span></a></p><script type="text/javascript" src="_intef_js.js"></script></body></html>